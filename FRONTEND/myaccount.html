<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>FLUXI | Mi cuenta</title>

  <!-- üîê VALIDACI√ìN DE SESI√ìN - EJECUTA ANTES DE RENDERIZAR -->
  <script>
    (function() {
      const token = localStorage.getItem('auth_token');
      const logoutTime = localStorage.getItem('logout_timestamp');
      if (!token || logoutTime) {
        localStorage.clear();
        window.location.replace('./login.html');
      }
    })();
  </script>


  <!-- Boxicons -->
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />

  <!-- Sidebar -->
  <link rel="stylesheet" href="./css/css-dashboard/css-sidebar.css">
  <!-- Estilos del widget -->
  <link rel="stylesheet" href="css/notification-widget.css">
  <!-- Notification Widget - Navbar Unificado -->
  <link rel="stylesheet" href="./css/notification-widget-unified.css" />
  <!-- Navbar Unificado -->
  <link rel="stylesheet" href="./css/navbar-unified.css" />

  <!-- Password Reset Modal -->
  <link rel="stylesheet" href="./css/css-dashboard/password-reset-modal.css">

  <!-- Mi cuenta styles -->
  <link rel="stylesheet" href="./css/css-dashboard/myaccount.css" />
</head>

<body>
  <div class="app-layout">

    <!-- SIDEBAR -->
    <div id="sidebar-container"></div>

    <!-- MAIN -->
    <main class="main-content">

      <!-- NAVBAR UNIFICADO -->
      <header class="fluxi-navbar">
        <div class="fluxi-navbar-left">
          <h1 class="fluxi-page-title" id="navbarPageTitle">Mi Cuenta</h1>
        </div>
        <div class="fluxi-navbar-brand">
          <img src="./assets/fluxi.png" class="fluxi-navbar-brand-logo" alt="FLUXI Logo" />
        </div>
        <div class="fluxi-navbar-right">
          <div class="fluxi-notification-icon" id="navNotificationIcon">
            <i class="bx bx-bell"></i>
            <span class="fluxi-notification-badge" id="navNotificationBadge" style="display: none;">0</span>
          </div>
          <div class="fluxi-user" id="navUserButton">
            <img src="./assets/mascota.jpeg" alt="Avatar" class="fluxi-user-avatar" id="navUserAvatar" />
            <span class="fluxi-username" id="navUsername">Usuario</span>
            <div class="fluxi-user-menu" id="navUserMenu">
              <button class="fluxi-user-menu-item" onclick="navigateToProfile()">
                <i class="bx bx-user"></i>
                <span>Mi Perfil</span>
              </button>
              <button class="fluxi-user-menu-item" onclick="navigateToSettings()">
                <i class="bx bx-cog"></i>
                <span>Configuraci√≥n</span>
              </button>
              <div class="fluxi-user-menu-divider"></div>
              <button class="fluxi-user-menu-item" onclick="logout()" style="color: #f5576c;">
                <i class="bx bx-log-out"></i>
                <span>Cerrar Sesi√≥n</span>
              </button>
            </div>
          </div>
        </div>
      </header>

      <!-- PAGE HEADER -->
      <section class="page-header">
        <h1 class="page-title">Mi cuenta</h1>
        <p class="page-subtitle">
          Administra tu informaci√≥n personal, seguridad y preferencias
        </p>
      </section>

      <!-- PROFILE CARD -->
      <section class="profile-card">
        <div class="profile-left">
          <img src="./assets/mascota.jpeg" />
          <div>
            <h2 data-user-name>Cargando...</h2>
            <span data-kyc-badge>Verificando...</span>
          </div>
        </div>

        <button class="primary-btn" id="editProfileBtn">
          <i class="bx bx-edit"></i>
          Editar perfil
        </button>
      </section>

      <!-- ACCOUNT GRID -->
      <section class="account-grid">

        <!-- INFORMACI√ìN PERSONAL -->
        <div class="account-box">
          <h3><i class='bx bx-user'></i> Informaci√≥n personal</h3>

          <div class="info-row">
            <span>Nombre de usuario</span>
            <strong data-username>-</strong>
          </div>

          <div class="info-row">
            <span>Nombre completo</span>
            <strong data-full-name>-</strong>
          </div>

          <div class="info-row">
            <span>Correo electr√≥nico</span>
            <strong data-email>-</strong>
          </div>

          <div class="info-row">
            <span>Tel√©fono</span>
            <strong data-phone>-</strong>
          </div>

          <div class="info-row">
            <span>Pa√≠s</span>
            <strong data-country>-</strong>
          </div>

          <div class="info-row">
            <span>Documento</span>
            <strong data-document>-</strong>
          </div>
        </div>

        <!-- INFORMACI√ìN DE LA EMPRESA -->
        <div class="account-box">
          <h3><i class='bx bx-buildings'></i> Informaci√≥n de la empresa</h3>

          <div class="info-row">
            <span>Raz√≥n social</span>
            <strong data-legal-name>-</strong>
          </div>

          <div class="info-row">
            <span>Nombre comercial</span>
            <strong data-trade-name>-</strong>
          </div>

          <div class="info-row">
            <span>NIT / RUT</span>
            <strong data-tax-id>-</strong>
          </div>

          <div class="info-row">
            <span>Correo corporativo</span>
            <strong data-corporate-email>-</strong>
          </div>

          <div class="info-row">
            <span>Tel√©fono corporativo</span>
            <strong data-corporate-phone>-</strong>
          </div>
        </div>

        <!-- VERIFICACI√ìN -->
        <div class="account-box">
          <h3><i class='bx bx-check-shield'></i> Verificaci√≥n</h3>

          <div class="verification-status" data-verification-status>
            <i class="bx bx-loader-circle"></i>
            <span>Verificando estado...</span>
          </div>

          <small data-verification-hint>
            Cargando informaci√≥n de verificaci√≥n...
          </small>
        </div>

        <!-- SEGURIDAD -->
        <div class="account-box">
          <h3><i class='bx bx-lock-alt'></i> Seguridad</h3>

          <div class="security-item">
            <div>
              <strong>Contrase√±a</strong>
              <span>‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</span>
            </div>
            <button id="changePasswordBtn">Cambiar</button>
          </div>

          <div class="security-item">
            <div>
              <strong>Autenticaci√≥n 2FA</strong>
              <span>Protecci√≥n adicional</span>
            </div>
            <button class="enabled">Configurar</button>
          </div>
        </div>

      </section>

    </main>
  </div>

  <!-- JS -->
  <script src="./js/js-dashboard/sidebar-loader.js" type="module"></script>
  <script type="module" src="./js/js-dashboard/myaccount.js"></script>
    <!-- Widget de notificaciones -->
    <script type="module" src="js/notification-widget.js"></script>

  <script src="./js/navbar-unified.js"></script>
<!-- üîê SISTEMA DE PERMISOS GLOBAL -->
<script type="module" src="./js/permissions/init-permissions.js"></script>
</body>
</html>